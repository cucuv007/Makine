<!DOCTYPE html>
<html lang="tr" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Otobüs Arıza Durumu</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-content">
                <div class="header-left">
                    <i class="fas fa-bus"></i>
                    <div>
                        <h1>Otobüs Arıza Durumu</h1>
                        <div class="user-info">
                            <i class="fas fa-user-circle"></i>
                            <span id="loggedUsername">-</span>
                            <button class="change-password-btn" onclick="openChangePasswordPopup()"
                                title="Şifre Değiştir">
                                <i class="fas fa-key"></i>
                            </button>
                            <button class="logout-btn" onclick="logout()" title="Çıkış Yap">
                                <i class="fas fa-sign-out-alt"></i>
                            </button>
                        </div>

                        <!-- Mini Bus Stats -->
                        <div class="mini-stats">
                            <div class="stat-badge 12m">
                                <i class="fas fa-bus"></i>
                                <span>12M: <strong id="count-12m">0</strong></span>
                            </div>
                            <div class="stat-badge 9m">
                                <i class="fas fa-bus"></i>
                                <span>9M: <strong id="count-9m">0</strong></span>
                            </div>
                            <div class="stat-badge 5m">
                                <i class="fas fa-shuttle-van"></i>
                                <span>5M: <strong id="count-5m">0</strong></span>
                            </div>
                        </div>

                    </div>
                </div>
                <button class="theme-toggle icon-only" onclick="toggleTheme()" title="Tema Değiştir">
                    <i class="fas fa-moon" id="theme-icon"></i>
                </button>
            </div>
        </div>

        <!-- Search Section -->
        <div class="search-section">
            <div class="search-grid">
                <div class="search-field">
                    <label for="searchSeriNo">
                        <i class="fas fa-hashtag"></i>
                        Seri No
                    </label>
                    <input type="text" id="searchSeriNo" placeholder="En az 3 karakter...">
                </div>

                <div class="search-field">
                    <label for="searchPlaka">
                        <i class="fas fa-car"></i>
                        Plaka
                    </label>
                    <input type="text" id="searchPlaka" placeholder="En az 3 karakter...">
                </div>

                <div class="search-field">
                    <label for="searchAriza">
                        <i class="fas fa-wrench"></i>
                        Arıza
                    </label>
                    <input type="text" id="searchAriza" placeholder="En az 3 karakter...">
                </div>

                <div class="search-field">
                    <label for="startDate">
                        <i class="fas fa-calendar-alt"></i>
                        Başlangıç Tarihi
                    </label>
                    <input type="date" id="startDate">
                </div>

                <div class="search-field">
                    <label for="endDate">
                        <i class="fas fa-calendar-check"></i>
                        Bitiş Tarihi
                    </label>
                    <input type="date" id="endDate">
                </div>
            </div>

            <div class="search-actions">
                <button class="btn btn-primary" onclick="applyFilters()">
                    <i class="fas fa-search"></i>
                    Ara
                </button>
                <button class="btn btn-secondary" onclick="clearFilters()">
                    <i class="fas fa-times"></i>
                    Temizle
                </button>
                <button class="btn btn-primary" onclick="refreshData()" title="Verileri Yenile">
                    <i class="fas fa-sync-alt"></i>
                    Yenile
                </button>
            </div>
        </div>

        <!-- Stats -->
        <div class="stats">
            <div class="stat-card">
                <i class="fas fa-database"></i>
                <div class="stat-info">
                    <span class="stat-label">Toplam Kayıt</span>
                    <span class="stat-value" id="totalCount">0</span>
                </div>
            </div>

            <div class="stat-card">
                <i class="fas fa-filter"></i>
                <div class="stat-info">
                    <span class="stat-label">Gösterilen</span>
                    <span class="stat-value" id="displayedCount">0</span>
                </div>
            </div>
        </div>

        <!-- Table -->
        <div class="table-container">
            <table class="data-table">
                <thead>
                    <tr>
                        <th><i class="fas fa-hashtag"></i> ID</th>
                        <th><i class="fas fa-hashtag"></i> Seri No</th>
                        <th><i class="fas fa-car"></i> Plaka</th>
                        <th><i class="fas fa-bus"></i> Tip</th>
                        <th><i class="fas fa-calendar-alt"></i> Giriş Tarihi</th>
                        <th><i class="fas fa-clock"></i> Giriş Saati</th>
                        <th><i class="fas fa-wrench"></i> Arıza</th>
                        <th><i class="fas fa-user"></i> Formu Açan</th>
                        <th><i class="fas fa-user-check"></i> Arızayı Kapatan</th>
                        <th><i class="fas fa-calendar-check"></i> Çıkış Tarihi</th>
                        <th><i class="fas fa-clock"></i> Çıkış Saati</th>
                        <th><i class="fas fa-info-circle"></i> Arıza Durumu</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <tr>
                        <td colspan="11" class="no-data">
                            <i class="fas fa-spinner fa-spin"></i><br>
                            Veriler yükleniyor...
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Limit Buttons -->
        <div class="limit-buttons">
            <button class="limit-btn active" id="btn-50" onclick="setLimit(50)">
                <i class="fas fa-list"></i>
                50
            </button>
            <button class="limit-btn" id="btn-100" onclick="setLimit(100)">
                <i class="fas fa-list"></i>
                100
            </button>
            <button class="limit-btn" id="btn-1000" onclick="setLimit(1000)">
                <i class="fas fa-list"></i>
                1000
            </button>
            <button class="limit-btn" id="btn-all" onclick="setLimit('all')">
                <i class="fas fa-infinity"></i>
                ALL
            </button>
            <button class="limit-btn btn-arizali" id="btn-arizali" onclick="setStatusFilter('arizali')">
                <i class="fas fa-exclamation-triangle"></i>
                ARIZALI
            </button>
            <button class="limit-btn btn-yapilanlar" id="btn-yapilanlar" onclick="setStatusFilter('yapilanlar')">
                <i class="fas fa-check-circle"></i>
                YAPILANLAR
            </button>
        </div>
    </div>

    <!-- Plaka Detay Popup -->
    <div id="platePopup" class="popup-overlay">
        <div class="popup-container" id="popupContent">
            <!-- Dinamik içerik buraya gelecek -->
        </div>
    </div>

    <!-- Şifre Değiştirme Popup -->
    <div id="changePasswordPopup" class="popup-overlay">
        <div class="popup-container">
            <div class="popup-header">
                <h2><i class="fas fa-key"></i> Şifre Değiştir</h2>
                <button class="popup-close" onclick="closeChangePasswordPopup()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="popup-body">
                <form id="changePasswordForm" class="change-password-form">
                    <input type="text" autocomplete="username" style="display:none;">
                    <div class="form-group">
                        <label for="currentPassword">
                            <i class="fas fa-lock"></i>
                            Mevcut Şifre
                        </label>
                        <input type="password" id="currentPassword" placeholder="Mevcut şifrenizi girin" required
                            autocomplete="current-password">
                    </div>

                    <div class="form-group">
                        <label for="newPassword">
                            <i class="fas fa-key"></i>
                            Yeni Şifre
                        </label>
                        <input type="password" id="newPassword" placeholder="Yeni şifrenizi girin" required
                            autocomplete="new-password">
                    </div>

                    <div class="form-group">
                        <label for="confirmPassword">
                            <i class="fas fa-check-circle"></i>
                            Yeni Şifre (Tekrar)
                        </label>
                        <input type="password" id="confirmPassword" placeholder="Yeni şifrenizi tekrar girin" required
                            autocomplete="new-password">
                    </div>

                    <div id="passwordError" class="error-message"></div>
                    <div id="passwordSuccess" class="success-message"></div>

                    <button type="submit" class="btn btn-primary" id="changePasswordBtn">
                        <i class="fas fa-save"></i>
                        Şifreyi Değiştir
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Scroll to Top Button -->
    <button id="scrollToTopBtn" onclick="scrollToTop()" title="Yukarı Çık">
        <i class="fas fa-chevron-up"></i>
    </button>

    <script src="config.js"></script>
    <script src="script.js"></script>
</body>

</html>
